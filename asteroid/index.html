<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Asteroid shader | asmgrinder’s page</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Asteroid shader" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Homepage for asmgrinder’s stuff." />
<meta property="og:description" content="Homepage for asmgrinder’s stuff." />
<link rel="canonical" href="/asteroid/" />
<meta property="og:url" content="/asteroid/" />
<meta property="og:site_name" content="asmgrinder’s page" />
<script type="application/ld+json">
{"url":"/asteroid/","headline":"Asteroid shader","description":"Homepage for asmgrinder’s stuff.","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="asmgrinder's page" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">asmgrinder&#39;s page</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/asteroid/">Asteroid shader</a><a class="page-link" href="/CV/">CV</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Asteroid shader</h1>
  </header>

  <div class="post-content">
    <h3 id="unity-asteroid-shader-documentation">Unity asteroid shader documentation</h3>

<h1 id="material-shader-asteroidshadergraph">Material shader (asteroid.shadergraph)</h1>

<p>This shader gives the sphere a highly detailed asteroid appearance. It is recommended to use subdivided enough icosphere geometry for body
 as its vertices are displaced during rendering and rest of mimic is done by normal mapping. Resulting height map is sum of base heightmap
 and random heightmap generated by shader. Normals for base heightmap are calculated during rendering based on heightmap.
 Normals for generated heightmap are calculated approximately by shader and combined with the base heightmap normals.</p>

<p><code class="language-plaintext highlighter-rouge">Albedo</code> - Cubemap with albedo of body.<br />
<code class="language-plaintext highlighter-rouge">Tint</code> - Overall color of body.<br />
<code class="language-plaintext highlighter-rouge">Heightmap</code> - Base heightmap of body (grayscale cubemap).<br />
<code class="language-plaintext highlighter-rouge">Range</code> - Base heightmap scale.<br />
<code class="language-plaintext highlighter-rouge">Metallic</code> - Metalic parameter of body.<br />
<code class="language-plaintext highlighter-rouge">Smoothness</code> - Smoothness parameter of body.<br />
<code class="language-plaintext highlighter-rouge">Denoise</code> - Level of denoising when rendering surface at angle (tradeoff between normals strength/scale and visual artefacts). Depends on render scale (URP settings).
 Weakens normals based on surface angle inside camera coordinate system.<br />
<code class="language-plaintext highlighter-rouge">Start octave</code> - scale of first level of generated noise.<br />
<code class="language-plaintext highlighter-rouge">Seed</code> - Random generator seed, changes generated heightmap and normals for body. (0.000..100.000)<br />
<code class="language-plaintext highlighter-rouge">Use mesh normals</code> - denoise is based on the normals in camera coordinate system. For lowpoly icosphere it can give better results for
 precalculated vertex displacement and recalculated normals. This parameter lets mix normals calculated by shader
 (for highly detailed geometry) and normals of used mesh. Influences only denoising, not needed if icosphere is highly subdivided.</p>

<h1 id="compute-shader-asteroidcompute">Compute shader (asteroid.compute)</h1>

<p>Computes displaced position of surface and normal for sphere points (normalizes points in input array before applying height).
 Requires <code class="language-plaintext highlighter-rouge">_TexHeightmap</code> (greyscaled cubemap), <code class="language-plaintext highlighter-rouge">_StartOctave</code> (int), <code class="language-plaintext highlighter-rouge">_Range</code> (float) and <code class="language-plaintext highlighter-rouge">_Seed</code> (float in range 0.000 .. 100.000).
 Their meaning is the same as for the material shader.</p>

<h1 id="script-stonescs">Script (stones.cs)</h1>

<p>Generates collider mesh if MeshCollider component is attached to scene node. Adjusts vertex positions and normals if <code class="language-plaintext highlighter-rouge">Use mesh normals</code> is checked.
 Generates rocks all over the surface of body if rock prefab is present in the corresponding slot
 (pyramid-like prefab can be used to visualize asteroid normals in positions of rock instances).
 Values of shader parameters should be the same as values of material parameters to obtain same surface otherwise rocks will be placed above or under the surface.</p>

<p><code class="language-plaintext highlighter-rouge">stonePrefab</code> - prefab for stone<br />
<code class="language-plaintext highlighter-rouge">computeShader</code> - asteroid.compute<br />
<code class="language-plaintext highlighter-rouge">cubemapHeightmap</code> - grayscale heightmap cubemap<br />
<code class="language-plaintext highlighter-rouge">StartOctave</code>, <code class="language-plaintext highlighter-rouge">Range</code>, <code class="language-plaintext highlighter-rouge">Seed</code> - should be equal to material ones<br />
<code class="language-plaintext highlighter-rouge">Use mesh normals</code> in the script displaces geometry of mesh and recalculates mesh normals at Start() to make correct normals for shader’s <code class="language-plaintext highlighter-rouge">Use mesh normals</code> and
 therefore requires read/write flag for the mesh to be set in import parameters if turned on. Rocks can also be above or under the surface
 if asteroid geometry is not subdivided enough or if rocks are too small because mesh geometry can’t be exactly aligned to resulting heightmap.</p>

<h1 id="usage">Usage</h1>
<p>Import subdivided enough (&gt; 6 times) icosphere (more is better for appearance and worse for performance).
 Create material based on material shader. Apply material to icosphere, select required cubemaps
 (bigger values on heightmap mean lower places on body so that abcence of base heightmap wouldn’t shrink body)
 and adjust material parameters. You can optionally attach <code class="language-plaintext highlighter-rouge">stones.cs</code>script to scene node if you want to use
 some of its functionality and/or mesh collider component. If so make sure that values of parameters that define
 body variant (<code class="language-plaintext highlighter-rouge">StartOctave</code>, <code class="language-plaintext highlighter-rouge">Range</code>, <code class="language-plaintext highlighter-rouge">Seed</code>) are the same as values of material parameters. Render scale equal
 to 2 (in URP parameters) lets you adjust denoiser to lower values without too much visual artifacts.</p>

<h1 id="requirements">Requirements</h1>
<p>Shader is rather lightweight, it runs in 1366x768 resolution on Intel HD Graphics 520.</p>

<h1 id="todo">TODO:</h1>
<ul>
  <li>Find another way to lower visual artifacts to avoid loss of detail</li>
  <li>Make use of tesselation</li>
</ul>

<h1 id="tutorial">Tutorial</h1>

<!-- https://www.youtube.com/watch?v=LG2fiORkHq8 -->
<iframe width="587" height="330" src="https://www.youtube.com/embed/LG2fiORkHq8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">asmgrinder&#39;s page</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">asmgrinder&#39;s page</li><li><a class="u-email" href="mailto:asmgrinder@gmail.com">asmgrinder@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/asmgrinder"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">asmgrinder</span></a></li><li><a href="https://youtube.com/asmgrinder"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#youtube"></use></svg> <span class="username">asmgrinder</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Homepage for asmgrinder&#39;s stuff.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
